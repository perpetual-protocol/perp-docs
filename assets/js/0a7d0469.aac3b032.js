"use strict";(self.webpackChunkperp_docs=self.webpackChunkperp_docs||[]).push([[28],{3905:(e,t,a)=>{a.d(t,{Zo:()=>k,kt:()=>N});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function d(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},l=Object.keys(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var p=r.createContext({}),o=function(e){var t=r.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},k=function(e){var t=o(e.components);return r.createElement(p.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,l=e.originalType,p=e.parentName,k=d(e,["components","mdxType","originalType","parentName"]),m=o(a),N=n,u=m["".concat(p,".").concat(N)]||m[N]||s[N]||l;return a?r.createElement(u,i(i({ref:t},k),{},{components:a})):r.createElement(u,i({ref:t},k))}));function N(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=a.length,i=new Array(l);i[0]=m;var d={};for(var p in t)hasOwnProperty.call(t,p)&&(d[p]=t[p]);d.originalType=e,d.mdxType="string"==typeof e?e:n,i[1]=d;for(var o=2;o<l;o++)i[o]=a[o];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}m.displayName="MDXCreateElement"},2732:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>s,frontMatter:()=>l,metadata:()=>d,toc:()=>o});var r=a(7462),n=(a(7294),a(3905));const l={},i=void 0,d={unversionedId:"contracts/AccountBalance",id:"contracts/AccountBalance",title:"AccountBalance",description:"Functions",source:"@site/docs/contracts/AccountBalance.md",sourceDirName:"contracts",slug:"/contracts/AccountBalance",permalink:"/docs/contracts/AccountBalance",draft:!1,editUrl:"https://github.com/perpetual-protocol/perp-docs/tree/main/docs/contracts/AccountBalance.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"IVirtualToken",permalink:"/docs/interfaces/IVirtualToken"},next:{title:"BaseToken",permalink:"/docs/contracts/BaseToken"}},p={},o=[{value:"Functions",id:"functions",level:2},{value:"initialize",id:"initialize",level:3},{value:"setVault",id:"setvault",level:3},{value:"modifyTakerBalance",id:"modifytakerbalance",level:3},{value:"Parameters:",id:"parameters",level:4},{value:"Return Values:",id:"return-values",level:4},{value:"modifyOwedRealizedPnl",id:"modifyowedrealizedpnl",level:3},{value:"Parameters:",id:"parameters-1",level:4},{value:"settleQuoteToOwedRealizedPnl",id:"settlequotetoowedrealizedpnl",level:3},{value:"Parameters:",id:"parameters-2",level:4},{value:"settleOwedRealizedPnl",id:"settleowedrealizedpnl",level:3},{value:"Parameters:",id:"parameters-3",level:4},{value:"Return Values:",id:"return-values-1",level:4},{value:"settleBalanceAndDeregister",id:"settlebalanceandderegister",level:3},{value:"Parameters:",id:"parameters-4",level:4},{value:"registerBaseToken",id:"registerbasetoken",level:3},{value:"Parameters:",id:"parameters-5",level:4},{value:"deregisterBaseToken",id:"deregisterbasetoken",level:3},{value:"Parameters:",id:"parameters-6",level:4},{value:"updateTwPremiumGrowthGlobal",id:"updatetwpremiumgrowthglobal",level:3},{value:"Parameters:",id:"parameters-7",level:4},{value:"settlePositionInClosedMarket",id:"settlepositioninclosedmarket",level:3},{value:"Parameters:",id:"parameters-8",level:4},{value:"Return Values:",id:"return-values-2",level:4},{value:"getClearingHouseConfig",id:"getclearinghouseconfig",level:3},{value:"Return Values:",id:"return-values-3",level:4},{value:"getOrderBook",id:"getorderbook",level:3},{value:"Return Values:",id:"return-values-4",level:4},{value:"getVault",id:"getvault",level:3},{value:"Return Values:",id:"return-values-5",level:4},{value:"getBaseTokens",id:"getbasetokens",level:3},{value:"Parameters:",id:"parameters-9",level:4},{value:"Return Values:",id:"return-values-6",level:4},{value:"getAccountInfo",id:"getaccountinfo",level:3},{value:"Parameters:",id:"parameters-10",level:4},{value:"Return Values:",id:"return-values-7",level:4},{value:"getTakerOpenNotional",id:"gettakeropennotional",level:3},{value:"getTotalOpenNotional",id:"gettotalopennotional",level:3},{value:"getTotalDebtValue",id:"gettotaldebtvalue",level:3},{value:"Parameters:",id:"parameters-11",level:4},{value:"Return Values:",id:"return-values-8",level:4},{value:"getPnlAndPendingFee",id:"getpnlandpendingfee",level:3},{value:"Parameters:",id:"parameters-12",level:4},{value:"Return Values:",id:"return-values-9",level:4},{value:"hasOrder",id:"hasorder",level:3},{value:"Parameters:",id:"parameters-13",level:4},{value:"Return Values:",id:"return-values-10",level:4},{value:"getLiquidatablePositionSize",id:"getliquidatablepositionsize",level:3},{value:"Parameters:",id:"parameters-14",level:4},{value:"Return Values:",id:"return-values-11",level:4},{value:"getMarkPrice",id:"getmarkprice",level:3},{value:"Parameters:",id:"parameters-15",level:4},{value:"Return Values:",id:"return-values-12",level:4},{value:"getBase",id:"getbase",level:3},{value:"Parameters:",id:"parameters-16",level:4},{value:"Return Values:",id:"return-values-13",level:4},{value:"getQuote",id:"getquote",level:3},{value:"Parameters:",id:"parameters-17",level:4},{value:"Return Values:",id:"return-values-14",level:4},{value:"getTakerPositionSize",id:"gettakerpositionsize",level:3},{value:"Parameters:",id:"parameters-18",level:4},{value:"Return Values:",id:"return-values-15",level:4},{value:"getTotalPositionSize",id:"gettotalpositionsize",level:3},{value:"Parameters:",id:"parameters-19",level:4},{value:"Return Values:",id:"return-values-16",level:4},{value:"getTotalPositionValue",id:"gettotalpositionvalue",level:3},{value:"Parameters:",id:"parameters-20",level:4},{value:"Return Values:",id:"return-values-17",level:4},{value:"getTotalAbsPositionValue",id:"gettotalabspositionvalue",level:3},{value:"Parameters:",id:"parameters-21",level:4},{value:"Return Values:",id:"return-values-18",level:4},{value:"getMarginRequirementForLiquidation",id:"getmarginrequirementforliquidation",level:3},{value:"Parameters:",id:"parameters-22",level:4},{value:"Return Values:",id:"return-values-19",level:4}],k={toc:o};function s(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,r.Z)({},k,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"functions"},"Functions"),(0,n.kt)("h3",{id:"initialize"},"initialize"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function initialize(\n  ) external\n")),(0,n.kt)("h3",{id:"setvault"},"setVault"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function setVault(\n  ) external\n")),(0,n.kt)("h3",{id:"modifytakerbalance"},"modifyTakerBalance"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function modifyTakerBalance(\n    address trader,\n    address baseToken,\n    int256 base,\n    int256 quote\n  ) external returns (int256, int256)\n")),(0,n.kt)("p",null,"Modify trader account balance"),(0,n.kt)("p",null,"Only used by ",(0,n.kt)("inlineCode",{parentName:"p"},"ClearingHouse")," contract"),(0,n.kt)("h4",{id:"parameters"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of the trader")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"baseToken")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of the baseToken")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"base")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Modified amount of base")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"quote")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Modified amount of quote")))),(0,n.kt)("h4",{id:"return-values"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"takerPositionSize")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Taker position size after modified")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"takerOpenNotional")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Taker open notional after modified")))),(0,n.kt)("h3",{id:"modifyowedrealizedpnl"},"modifyOwedRealizedPnl"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function modifyOwedRealizedPnl(\n    address trader,\n    int256 amount\n  ) external\n")),(0,n.kt)("p",null,"Modify trader owedRealizedPnl"),(0,n.kt)("p",null,"Only used by ",(0,n.kt)("inlineCode",{parentName:"p"},"ClearingHouse")," contract"),(0,n.kt)("h4",{id:"parameters-1"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of the trader")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"amount")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Modified amount of owedRealizedPnl")))),(0,n.kt)("h3",{id:"settlequotetoowedrealizedpnl"},"settleQuoteToOwedRealizedPnl"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function settleQuoteToOwedRealizedPnl(\n    address trader,\n    address baseToken,\n    int256 amount\n  ) external\n")),(0,n.kt)("p",null,"Modify trader owedRealizedPnl"),(0,n.kt)("p",null,"Only used by ",(0,n.kt)("inlineCode",{parentName:"p"},"ClearingHouse")," contract"),(0,n.kt)("h4",{id:"parameters-2"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of the trader")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"baseToken")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of the baseToken")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"amount")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Settled quote amount")))),(0,n.kt)("h3",{id:"settleowedrealizedpnl"},"settleOwedRealizedPnl"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function settleOwedRealizedPnl(\n    address trader\n  ) external returns (int256)\n")),(0,n.kt)("p",null,"Settle owedRealizedPnl"),(0,n.kt)("p",null,"Only used by ",(0,n.kt)("inlineCode",{parentName:"p"},"Vault.withdraw()")),(0,n.kt)("h4",{id:"parameters-3"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of the trader")))),(0,n.kt)("h4",{id:"return-values-1"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"pnl")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Settled owedRealizedPnl")))),(0,n.kt)("h3",{id:"settlebalanceandderegister"},"settleBalanceAndDeregister"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function settleBalanceAndDeregister(\n    address trader,\n    address baseToken,\n    int256 takerBase,\n    int256 takerQuote,\n    int256 realizedPnl,\n    int256 makerFee\n  ) external\n")),(0,n.kt)("p",null,"Settle account balance and deregister base token"),(0,n.kt)("p",null,"Only used by ",(0,n.kt)("inlineCode",{parentName:"p"},"ClearingHouse")," contract"),(0,n.kt)("h4",{id:"parameters-4"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of the trader")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"baseToken")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of the baseToken")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"takerBase")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Modified amount of taker base")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"takerQuote")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Modified amount of taker quote")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"realizedPnl")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Amount of pnl realized")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"makerFee")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Amount of maker fee collected from pool")))),(0,n.kt)("h3",{id:"registerbasetoken"},"registerBaseToken"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function registerBaseToken(\n    address trader,\n    address baseToken\n  ) external\n")),(0,n.kt)("p",null,"Every time a trader's position value is checked, the base token list of this trader will be traversed;\nthus, this list should be kept as short as possible"),(0,n.kt)("p",null,"Only used by ",(0,n.kt)("inlineCode",{parentName:"p"},"ClearingHouse")," contract"),(0,n.kt)("h4",{id:"parameters-5"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of the trader")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"baseToken")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of the trader's base token")))),(0,n.kt)("h3",{id:"deregisterbasetoken"},"deregisterBaseToken"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function deregisterBaseToken(\n    address trader,\n    address baseToken\n  ) external\n")),(0,n.kt)("p",null,"Deregister baseToken from trader accountInfo"),(0,n.kt)("p",null,"Only used by ",(0,n.kt)("inlineCode",{parentName:"p"},"ClearingHouse")," contract, this function is expensive, due to for loop"),(0,n.kt)("h4",{id:"parameters-6"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of the trader")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"baseToken")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of the trader's base token")))),(0,n.kt)("h3",{id:"updatetwpremiumgrowthglobal"},"updateTwPremiumGrowthGlobal"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function updateTwPremiumGrowthGlobal(\n    address trader,\n    address baseToken,\n    int256 lastTwPremiumGrowthGlobalX96\n  ) external\n")),(0,n.kt)("p",null,"Update trader Twap premium info"),(0,n.kt)("p",null,"Only used by ",(0,n.kt)("inlineCode",{parentName:"p"},"ClearingHouse")," contract"),(0,n.kt)("h4",{id:"parameters-7"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of trader")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"baseToken")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of baseToken")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"lastTwPremiumGrowthGlobalX96")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The last Twap Premium")))),(0,n.kt)("h3",{id:"settlepositioninclosedmarket"},"settlePositionInClosedMarket"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function settlePositionInClosedMarket(\n    address trader,\n    address baseToken\n  ) external returns (int256 positionNotional, int256 openNotional, int256 realizedPnl, uint256 closedPrice)\n")),(0,n.kt)("p",null,"Settle trader's PnL in closed market"),(0,n.kt)("p",null,"we don't do swap to get position notional here.\nwe define the position notional in a closed market is ",(0,n.kt)("inlineCode",{parentName:"p"},"closed price * position size")),(0,n.kt)("h4",{id:"parameters-8"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of the trader")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"baseToken")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of the trader's base token")))),(0,n.kt)("h4",{id:"return-values-2"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"positionNotional")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Taker's position notional settled with closed price")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"openNotional")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Taker's open notional")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"realizedPnl")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Settled realized pnl")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"closedPrice")),(0,n.kt)("td",{parentName:"tr",align:"left"},"uint256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The closed price of the closed market")))),(0,n.kt)("h3",{id:"getclearinghouseconfig"},"getClearingHouseConfig"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function getClearingHouseConfig(\n  ) external returns (address)\n")),(0,n.kt)("p",null,"Get ",(0,n.kt)("inlineCode",{parentName:"p"},"ClearingHouseConfig")," address"),(0,n.kt)("h4",{id:"return-values-3"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"clearingHouseConfig")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of ClearingHouseConfig")))),(0,n.kt)("h3",{id:"getorderbook"},"getOrderBook"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function getOrderBook(\n  ) external returns (address)\n")),(0,n.kt)("p",null,"Get ",(0,n.kt)("inlineCode",{parentName:"p"},"OrderBook")," address"),(0,n.kt)("h4",{id:"return-values-4"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"orderBook")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of OrderBook")))),(0,n.kt)("h3",{id:"getvault"},"getVault"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function getVault(\n  ) external returns (address)\n")),(0,n.kt)("p",null,"Get ",(0,n.kt)("inlineCode",{parentName:"p"},"Vault")," address"),(0,n.kt)("h4",{id:"return-values-5"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"vault")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of Vault")))),(0,n.kt)("h3",{id:"getbasetokens"},"getBaseTokens"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function getBaseTokens(\n    address trader\n  ) external returns (address[])\n")),(0,n.kt)("p",null,"Get trader registered baseTokens"),(0,n.kt)("h4",{id:"parameters-9"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of trader")))),(0,n.kt)("h4",{id:"return-values-6"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"baseTokens")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address[]"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The array of baseToken address")))),(0,n.kt)("h3",{id:"getaccountinfo"},"getAccountInfo"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function getAccountInfo(\n    address trader,\n    address baseToken\n  ) external returns (struct AccountMarket.Info)\n")),(0,n.kt)("p",null,"Get trader account info"),(0,n.kt)("h4",{id:"parameters-10"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of trader")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"baseToken")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of baseToken")))),(0,n.kt)("h4",{id:"return-values-7"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"traderAccountInfo")),(0,n.kt)("td",{parentName:"tr",align:"left"},"struct AccountMarket.Info"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The baseToken account info of trader")))),(0,n.kt)("h3",{id:"gettakeropennotional"},"getTakerOpenNotional"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function getTakerOpenNotional(\n  ) external returns (int256)\n")),(0,n.kt)("h3",{id:"gettotalopennotional"},"getTotalOpenNotional"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function getTotalOpenNotional(\n  ) external returns (int256)\n")),(0,n.kt)("h3",{id:"gettotaldebtvalue"},"getTotalDebtValue"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function getTotalDebtValue(\n    address trader\n  ) external returns (uint256)\n")),(0,n.kt)("p",null,"Get total debt value of trader"),(0,n.kt)("p",null,"Total debt value will relate to ",(0,n.kt)("inlineCode",{parentName:"p"},"Vault.getFreeCollateral()")),(0,n.kt)("h4",{id:"parameters-11"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of trader")))),(0,n.kt)("h4",{id:"return-values-8"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"totalDebtValue")),(0,n.kt)("td",{parentName:"tr",align:"left"},"uint256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The debt value of trader")))),(0,n.kt)("h3",{id:"getpnlandpendingfee"},"getPnlAndPendingFee"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function getPnlAndPendingFee(\n    address trader\n  ) external returns (int256, int256, uint256)\n")),(0,n.kt)("p",null,"Get owedRealizedPnl, unrealizedPnl and pending fee"),(0,n.kt)("h4",{id:"parameters-12"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of trader")))),(0,n.kt)("h4",{id:"return-values-9"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"owedRealizedPnl")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"the pnl realized already but stored temporarily in AccountBalance")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"unrealizedPnl")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"the pnl not yet realized")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"pendingFee")),(0,n.kt)("td",{parentName:"tr",align:"left"},"uint256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"the pending fee of maker earned")))),(0,n.kt)("h3",{id:"hasorder"},"hasOrder"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function hasOrder(\n    address trader\n  ) external returns (bool)\n")),(0,n.kt)("p",null,"Check trader has open order in open/closed market."),(0,n.kt)("h4",{id:"parameters-13"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of trader")))),(0,n.kt)("h4",{id:"return-values-10"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"True")),(0,n.kt)("td",{parentName:"tr",align:"left"},"bool"),(0,n.kt)("td",{parentName:"tr",align:"left"},"of false")))),(0,n.kt)("h3",{id:"getliquidatablepositionsize"},"getLiquidatablePositionSize"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function getLiquidatablePositionSize(\n    address trader,\n    address baseToken,\n    int256 accountValue\n  ) external returns (int256)\n")),(0,n.kt)("p",null,"Get liquidatable position size of trader's baseToken market"),(0,n.kt)("h4",{id:"parameters-14"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of trader")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"baseToken")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of baseToken")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"accountValue")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The account value of trader")))),(0,n.kt)("h4",{id:"return-values-11"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"liquidatablePositionSize")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The liquidatable position size of trader's baseToken market")))),(0,n.kt)("h3",{id:"getmarkprice"},"getMarkPrice"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function getMarkPrice(\n    address baseToken\n  ) external returns (uint256)\n")),(0,n.kt)("p",null,"Get mark price of baseToken market"),(0,n.kt)("p",null,"Mark price is the median of three prices as below."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"   1. current market price\n   2. market twap with 30 mins\n   3. index price + premium with 15 mins\n")),(0,n.kt)("p",null,"If the parameters to calculate mark price are not set, returns index twap instead for backward compatible\nIf the market is paused, returns index twap instead, that will be the index twap while pausing market"),(0,n.kt)("h4",{id:"parameters-15"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"baseToken")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of baseToken")))),(0,n.kt)("h4",{id:"return-values-12"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"price")),(0,n.kt)("td",{parentName:"tr",align:"left"},"uint256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The mark price of baseToken market")))),(0,n.kt)("h3",{id:"getbase"},"getBase"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function getBase(\n    address trader,\n    address baseToken\n  ) public returns (int256)\n")),(0,n.kt)("p",null,"Get trader base amount"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"base amount = takerPositionSize - orderBaseDebt")),(0,n.kt)("h4",{id:"parameters-16"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of trader")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"baseToken")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of baseToken")))),(0,n.kt)("h4",{id:"return-values-13"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"baseAmount")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The base amount of trader's baseToken market")))),(0,n.kt)("h3",{id:"getquote"},"getQuote"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function getQuote(\n    address trader,\n    address baseToken\n  ) public returns (int256)\n")),(0,n.kt)("p",null,"Get trader quote amount"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"quote amount = takerOpenNotional - orderQuoteDebt")),(0,n.kt)("h4",{id:"parameters-17"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of trader")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"baseToken")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of baseToken")))),(0,n.kt)("h4",{id:"return-values-14"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"quoteAmount")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The quote amount of trader's baseToken market")))),(0,n.kt)("h3",{id:"gettakerpositionsize"},"getTakerPositionSize"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function getTakerPositionSize(\n    address trader,\n    address baseToken\n  ) public returns (int256)\n")),(0,n.kt)("p",null,"Get taker position size of trader's baseToken market"),(0,n.kt)("p",null,"This will only has taker position, can get maker impermanent position through ",(0,n.kt)("inlineCode",{parentName:"p"},"getTotalPositionSize")),(0,n.kt)("h4",{id:"parameters-18"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of trader")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"baseToken")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of baseToken")))),(0,n.kt)("h4",{id:"return-values-15"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"takerPositionSize")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The taker position size of trader's baseToken market")))),(0,n.kt)("h3",{id:"gettotalpositionsize"},"getTotalPositionSize"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function getTotalPositionSize(\n    address trader,\n    address baseToken\n  ) public returns (int256)\n")),(0,n.kt)("p",null,"Get total position size of trader's baseToken market"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"total position size = taker position size + maker impermanent position size")),(0,n.kt)("h4",{id:"parameters-19"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of trader")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"baseToken")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of baseToken")))),(0,n.kt)("h4",{id:"return-values-16"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"totalPositionSize")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The total position size of trader's baseToken market")))),(0,n.kt)("h3",{id:"gettotalpositionvalue"},"getTotalPositionValue"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function getTotalPositionValue(\n    address trader,\n    address baseToken\n  ) public returns (int256)\n")),(0,n.kt)("p",null,"Get total position value of trader's baseToken market"),(0,n.kt)("p",null,"A negative returned value is only be used when calculating pnl,\nwe use mark price to calc position value"),(0,n.kt)("h4",{id:"parameters-20"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of trader")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"baseToken")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of baseToken")))),(0,n.kt)("h4",{id:"return-values-17"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"totalPositionValue")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Total position value of trader's baseToken market")))),(0,n.kt)("h3",{id:"gettotalabspositionvalue"},"getTotalAbsPositionValue"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function getTotalAbsPositionValue(\n    address trader\n  ) public returns (uint256)\n")),(0,n.kt)("p",null,"Get all market position abs value of trader"),(0,n.kt)("h4",{id:"parameters-21"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of trader")))),(0,n.kt)("h4",{id:"return-values-18"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"totalAbsPositionValue")),(0,n.kt)("td",{parentName:"tr",align:"left"},"uint256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Sum up positions value of every market")))),(0,n.kt)("h3",{id:"getmarginrequirementforliquidation"},"getMarginRequirementForLiquidation"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-solidity"},"  function getMarginRequirementForLiquidation(\n    address trader\n  ) public returns (int256)\n")),(0,n.kt)("p",null,"Get margin requirement to check whether trader will be able to liquidate"),(0,n.kt)("p",null,"This is different from ",(0,n.kt)("inlineCode",{parentName:"p"},"Vault._getTotalMarginRequirement()"),", which is for freeCollateral calculation"),(0,n.kt)("h4",{id:"parameters-22"},"Parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"trader")),(0,n.kt)("td",{parentName:"tr",align:"left"},"address"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The address of trader")))),(0,n.kt)("h4",{id:"return-values-19"},"Return Values:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"marginRequirementForLiquidation")),(0,n.kt)("td",{parentName:"tr",align:"left"},"int256"),(0,n.kt)("td",{parentName:"tr",align:"left"},"It is compared with ",(0,n.kt)("inlineCode",{parentName:"td"},"ClearingHouse.getAccountValue")," which is also an int")))))}s.isMDXComponent=!0}}]);